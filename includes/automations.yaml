###############################################################################
#
#                                 AUTOMATIONS
#
###############################################################################
  - alias: "Spegne il pc in caso salti la luce e manda una notifica"
    trigger:
      - platform: state
        entity_id: binary_sensor.zidoo
        to: 'off'
    condition:
      - condition: state
        entity_id: binary_sensor.computersalotto
        state: 'on'
    action:
      - service: switch.turn_off
        entity_id: switch.windows
      - service: notify.notify
        data:
          message: "E' saltata la luce."
#dopo tot minuti spegnere hassio
#******************************************************************************
  - alias: "Restart HA during the weekdays"
    trigger: 
      platform: time
      at: "16:30:00"
    condition:
      condition: time
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
    action:
      - service: notify.notify
        data:
          message: "Home Assistant in riavvio automatico giornaliero."
      - service: homeassistant.restart
#******************************************************************************
  - alias: "Restart HA during the weekend"
    trigger: 
      platform: time
      at: "08:00:00"
    condition:
      condition: time
      weekday:
      - sat
      - sun
    action:
      - service: homeassistant.restart
#******************************************************************************
  - alias: Startup Notification
    trigger:
      - platform: homeassistant
        event: start
    action:
      - service: notify.notify
        data:
          message: "Home Assistant è attivo."
      - service: hassio.addon_stdin
        data:
          addon: de3cd379_audio_player
          input: "http://192.168.1.100:8123/local/computer_activate.mp3"
      - service: group.set_visibility
        entity_id: group.airconditioner
        data:
          visible: False
      - service: group.set_visibility
        entity_id: group.termoventilatore_bagno
        data:
          visible: False
      - service: group.set_visibility
        entity_id: group.media_salotto
        data:
          visible: False
      - service: group.set_visibility
        entity_id: group.radio
        data:
          visible: False
      - service: group.set_visibility
        entity_id: group.telecomando_tv
        data:
          visible: False
      - service: group.set_visibility
        entity_id: group.tastierino_sky
        data:
          visible: False
      - service: group.set_visibility
        entity_id: group.telecomando_sky
        data:
          visible: False
      - service: google_assistant.request_sync
#******************************************************************************
  - alias: "Shutdown/Reboot Notification"
    trigger:
      - platform: homeassistant
        event: shutdown
    action:
      - service: notify.notify
        data:
          message: "Home Assistant è in riavvio."
      - service: hassio.addon_stdin
        data:
          addon: de3cd379_audio_player
          input: "http://192.168.1.100:8123/local/hologram_off.mp3"
#******************************************************************************
  - alias: "Togli Visibilita Gruppo Webcam"
    trigger:
      - platform: homeassistant
        event: start
    action:
    - service: group.set_visibility
      entity_id: group.webcam_casa
      data:
        visible: False
    - service: hassio.addon_stdin
      data:
        addon: de3cd379_audio_player
        input: "http://192.168.1.100:8123/local/tos-redalert.wav"
#******************************************************************************
  - alias: "Cambia Visibilita Gruppo Webcam"
    trigger:
    - platform: state
      entity_id: input_number.visibilita_gruppo
    action:
    - service: group.set_visibility
      entity_id: group.webcam_casa
      data_template:
        visible: >
          {% if is_state("input_number.visibilita_gruppo", "24.0") %}
            True
          {% else %}
            False
          {% endif %}
#******************************************************************************
  - alias: "Cambia Visibilita Telecomando Condizionatori"
    trigger:
    - platform: state
      entity_id: input_boolean.telecomando_visibile
    action:
    - service: group.set_visibility
      entity_id: group.airconditioner
      data_template:
        visible: >
          {% if is_state("input_boolean.telecomando_visibile", "on") %}
            True
          {% else %}
            False
          {% endif %}
#******************************************************************************
  - alias: "Cambia Visibilita Telecomando Termoventilatore"
    trigger:
    - platform: state
      entity_id: input_boolean.visualizza_telecomando_termoventilatore
    action:
    - service: group.set_visibility
      entity_id: group.termoventilatore_bagno
      data_template:
        visible: >
          {% if is_state("input_boolean.visualizza_telecomando_termoventilatore", "on") %}
            True
          {% else %}
            False
          {% endif %}
#******************************************************************************
  - alias: "Cambia Visibilita Telecomando MEDIA"
    trigger:
    - platform: state
      entity_id: input_boolean.visualizza_telecomando_tv
    action:
    - service: group.set_visibility
      entity_id: group.media_salotto
      data_template:
        visible: >
          {% if is_state("input_boolean.visualizza_telecomando_tv", "on") %}
            True
          {% else %}
            False
          {% endif %}
#******************************************************************************
  - alias: "Cambia Visibilita Telecomando Radio"
    trigger:
    - platform: state
      entity_id: input_boolean.visualizza_telecomando_radio
    action:
    - service: group.set_visibility
      entity_id: group.radio
      data_template:
        visible: >
          {% if is_state("input_boolean.visualizza_telecomando_radio", "on") %}
            True
          {% else %}
            False
          {% endif %}
#******************************************************************************
  - alias: "Cambia Visibilita Telecomando TV"
    trigger:
    - platform: state
      entity_id: input_boolean.visualizza_telecomando_televisione
    action:
    - service: group.set_visibility
      entity_id: group.telecomando_tv
      data_template:
        visible: >
          {% if is_state("input_boolean.visualizza_telecomando_televisione", "on") %}
            True
          {% else %}
            False
          {% endif %}
#******************************************************************************
  - alias: "Cambia Visibilita Tastierino SKY"
    trigger:
    - platform: state
      entity_id: input_boolean.visualizza_tastierino_sky
    action:
    - service: group.set_visibility
      entity_id: group.tastierino_sky
      data_template:
        visible: >
          {% if is_state("input_boolean.visualizza_tastierino_sky", "on") %}
            True
          {% else %}
            False
          {% endif %}
#******************************************************************************
  - alias: "Cambia Visibilita Telecomando SKY"
    trigger:
    - platform: state
      entity_id: input_boolean.visualizza_telecomando_sky
    action:
    - service: group.set_visibility
      entity_id: group.telecomando_sky
      data_template:
        visible: >
          {% if is_state("input_boolean.visualizza_telecomando_sky", "on") %}
            True
          {% else %}
            False
          {% endif %}
#******************************************************************************
  - alias: "Notify I am home"
    trigger:
    - platform: state
      entity_id: input_boolean.mxhome
      to: 'on'
    action:
    - service: notify.notify
      data:
        message: "Welcome home"
        target: "Smartphone Max"
        data:
          actions:
            - action: "button1"
              title: "Luce cucina"
            - action: "button2"
              title: "Luci cucina e salotto"
#******************************************************************************
  - alias: "HTML5 push notification action button clicked"
    trigger:
    - platform: event
      event_type: html5_notification.clicked
      event_data:
        action: manual_action
    action:
    - service_template: >
       {{ trigger.event.data.data["entityType"] }}.{{ trigger.event.data.data["secureAction"] }}
      data_template:
        entity_id: >
         {{ trigger.event.data.data["entityName"] }}
#******************************************************************************
  - alias: "HTML5 push notification action button clicked Turn on lights"
    trigger:
      platform: event
      event_type: html5_notification.clicked
      event_data:
        action: button1
    action:
      - service: light.turn_on
        entity_id: group.kitchen
#******************************************************************************
  - alias: "HTML5 push notification action button clicked Turn on lights 2"
    trigger:
      platform: event
      event_type: html5_notification.clicked
      event_data:
        action: button2
    action:
      - service: light.turn_on
        entity_id: group.kitchen
      - service: light.turn_on
        entity_id: group.living_room
#******************************************************************************        